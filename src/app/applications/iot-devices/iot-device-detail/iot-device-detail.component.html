<div *ngIf="device">
    <ng-container>
        <app-top-bar [data]="device" [backButton]="backButton" [subPage]="true"></app-top-bar>
    </ng-container>
    <!-- General details & map -->
    <app-iot-device-detail-generic [device]="device" [longitude]=longitude [latitude]="latitude">
    </app-iot-device-detail-generic>
    <div class="row">
        <div class="col-md-6 d-flex align-items-stretch">
            <div class="jumbotron jumbotron--m-right">
                <!-- Datapackage & Downlink -->
                <mat-tab-group animationDuration="200ms">
                    <mat-tab label="{{'IOTDEVICE.DETAIL-TAB' | translate}}">
                        <h4>{{ 'IOTDEVICE.DATAPACKAGE' | translate }}</h4>
                        <ng-container *ngIf="device.latestReceivedMessage?.sentTime; then sentTime; else noSentTime">
                        </ng-container>
                        <ng-template #sentTime>
                            <mat-expansion-panel>
                                <mat-expansion-panel-header style="max-width: max-content;">
                                    <mat-panel-title>
                                        <p>
                                            {{'IOTDEVICE.LATEST-DATAPACKAGE' | translate}}
                                            {{device.latestReceivedMessage?.sentTime | date:'medium'}}
                                        </p>
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <ng-container *ngIf="device.latestReceivedMessage?.rawData">
                                    <code>
                                            <pre>{{device.latestReceivedMessage.rawData | json }}</pre>
                                        </code>
                                </ng-container>
                            </mat-expansion-panel>
                        </ng-template>
                        <ng-template #noSentTime>
                            <p class="mb-5">
                                {{'IOTDEVICE.NO-DATAPACKAGE' | translate}}
                            </p>
                        </ng-template>
                        <!-- API -->
                        <ng-container *ngIf="device.type === 'GENERIC_HTTP'">
                            <h4>{{ 'IOTDEVICE.GENERIC_HTTP.APIKEY' | translate }}</h4>
                            <!-- <p>{{ 'IOTDEVICE.GENERIC_HTTP.INSTRUCTIONS' | translate }}</p> -->
                            <pre>{{ getGenericHttpDeviceUrl(device) }}</pre>
                        </ng-container>

                    </mat-tab>
                    <mat-tab label="{{'IOTDEVICE.DOWNLINK-TAB' | translate}}">
                        <app-downlink [device]="device" [errorMessages]="errorMessages"></app-downlink>
                    </mat-tab>
                </mat-tab-group>
            </div>
        </div>
        <!-- Device model -->
        <div class="col-md-6 d-flex align-items-stretch">
            <div class="jumbotron jumbotron--m-left">
                <app-device-model [device]="device"></app-device-model>
            </div>
        </div>
    </div>

</div>