<app-loading-spinner *ngIf="isLoadingResults; else showContent">
</app-loading-spinner>

<div #showContent>
    <div class="m-md-4">
        <h3>{{'SEARCH.QUERY' | translate}} {{searchText}}</h3>
    </div>


    <div class=" mat-elevation-z8">
        <table mat-table [dataSource]="dataSource" matSort matSortActive="name" matSortDirection="asc">
            <!-- Icon Column -->
            <ng-container matColumnDef="icon">
                <th mat-header-cell *matHeaderCellDef>
                    {{ 'SEARCH.ICON' | translate }}
                </th>
                <td mat-cell *matCellDef="let element">
                    <fa-icon [icon]="getIcon(element.type)"></fa-icon>
                </td>
            </ng-container>

            <!-- Type Column -->
            <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef mat-sort-header matSortDisableClear>
                    {{ 'SEARCH.TYPE' | translate }}</th>
                <td mat-cell *matCellDef="let element">
                    <div *ngIf="element.type == 'IoTDevice'; else typeElse">
                        {{element.deviceType | translate}}
                    </div>
                    <ng-template #typeElse>
                        {{element.type}}
                    </ng-template>
                </td>
            </ng-container>
            <!-- Name Column -->
            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header matSortDisableClear>
                    {{ 'SEARCH.NAME' | translate }}</th>
                <td mat-cell *matCellDef="let element">
                    <a class="application-link" (click)="goToResult()">{{element.name}}</a>
                </td>
            </ng-container>
            <!-- Id Column -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef>
                    {{ 'SEARCH.ID' | translate }}</th>
                <td mat-cell *matCellDef="let element">
                    <div *ngIf="element.type == 'IoTDevice'">
                        <div *ngIf="element.deviceType == 'LORAWAN'">
                            {{element.deviceEUI}}
                        </div>
                        <div *ngIf="element.deviceType == 'SIGFOX'">
                            {{element.deviceId}}
                        </div>
                        <div *ngIf="element.deviceType == 'GENERIC_HTTP'">
                            {{element.apiKey}}
                        </div>
                    </div>
                    <div *ngIf="element.type == 'Application'" class="application-link">{{element.id}}</div>
                    <div *ngIf="element.type == 'Gateway'" class="application-link">{{element.gatewayId}}
                    </div>
                </td>
            </ng-container>
            <!-- Org Column -->
            <ng-container matColumnDef="org">
                <th mat-header-cell *matHeaderCellDef mat-sort-header matSortDisableClear>
                    {{ 'SEARCH.ORGANISATION' | translate }}</th>
                <td mat-cell *matCellDef="let element">
                    {{element.organizationName}}
                </td>
            </ng-container>


            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator *ngIf="resultsLength" [pageSizeOptions]="[5, 10, 20]" [length]="resultsLength"
            showFirstLastButtons></mat-paginator>
    </div>
</div>